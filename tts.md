# TTS (Text-to-Speech) API 文档

本文档描述了如何调用后端的文本转语音接口。

## 接口描述

将给定的文本转换为语音音频流。

- **路径:** `/tts`
- **方法:** `POST`
- **内容类型:** `application/json`

## 请求体

请求体应为一个 JSON 对象，包含以下字段：

| 字段       | 类型   | 是否必需 | 描述                                                                                                               | 默认值 | 示例值        |
| :--------- | :----- | :------- | :----------------------------------------------------------------------------------------------------------------- | :----- | :------------ |
| `text`     | string | 是       | 需要转换为语音的文本内容。                                                                                         | -      | "Hello world" |
| `language` | string | 否       | 指定文本的语言代码，用于选择合适的默认音色。如果未提供，默认为英语。支持的值示例：'en', 'zh'。                     | 'en'   | "zh"          |
| `voice`    | string | 否       | 指定使用的发音人（音色）ID。如果提供，将覆盖根据 `language` 选择的默认音色。可用音色请参考阿里云智能语音交互文档。 | -      | "Aiyu"        |

**逻辑说明:**

1.  如果提供了 `voice`，则优先使用指定的 `voice`。
2.  如果没有提供 `voice`，则根据 `language` 的值选择默认音色：
    - `language` 为 'zh' 或 'zh-cn' 时，默认使用中文音色（如 'aixia'）。
    - `language` 为 'en' 或 'en-us' 或未提供 (默认为 'en') 时，默认使用英文音色（如 'Sean'）。

**示例请求体:**

```json
// 使用默认语言 (en) 和默认英文音色
{
  "text": "This is a test."
}

// 指定语言为中文，使用默认中文音色
{
  "text": "这是一个测试。",
  "language": "zh"
}

// 指定语言为中文，并指定特定中文音色
{
  "text": "指定一个不同的声音。",
  "language": "zh",
  "voice": "Aiyu"
}

// 指定特定英文音色 (language 字段此时可选，但提供无妨)
{
  "text": "Specify a different voice.",
  "language": "en",
  "voice": "Olivia"
}
```

```

## 响应

- **成功响应 (HTTP 状态码 200):**

  - **内容类型:** `audio/mpeg`
  - **响应体:** 返回 MP3 格式的音频数据流。客户端可以直接播放此流。

- **失败响应:**
  - **HTTP 状态码 400 (Bad Request):** 请求体验证失败（例如，缺少 `text` 字段）。响应体通常包含错误详情。
  - **HTTP 状态码 500 (Internal Server Error):** 后端处理过程中发生错误，例如：
    - 无法获取有效的阿里云 Access Token（**注意：Token 获取逻辑需要开发者自行实现**）。
    - 调用阿里云 TTS 服务失败。
    - 其他内部错误。
      响应体可能包含错误信息。

## 注意事项

1.  **Token:** 当前后端服务直接使用 `.env` 文件中配置的 `ALIYUN_TOKEN`。请确保此 Token 有效且未过期。为了长期稳定运行，建议后续实现动态 Token 获取和刷新逻辑。
2.  **可用音色:** `voice` 参数的可选值以及各语言的默认音色（如 'Sean', 'aixia'）取决于阿里云智能语音交互服务。请查阅最新的阿里云官方文档获取支持的音色 ID 列表。
3.  **错误处理:** 客户端应妥善处理可能出现的网络错误和服务器错误（如 400, 500 状态码）。
```
